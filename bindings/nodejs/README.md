# IOTA SDK Library - Node.js binding

## Table of contents

- [Requirements (only for building the binary yourself)](#requirements-only-for-building-the-binary-yourself)
- [Getting Started](#getting-started)
    - [Install the IOTA SDK](#install-the-iota-sdk)
    - [Usage](#usage)
      - [Wallet](#wallet)
      - [Client](#client)
      - [Examples](#examples)
- [Available Scripts](#available-scripts)
    - [`npm install`](#npm-install)
    - [`npm build`](#npm-build)
    - [`npm test`](#npm-test)
    - [Cargo.toml](#cargotoml)
    - [README.md](#readmemd)
    - [index.node](#indexnode)
    - [package.json](#packagejson)
    - [src/](#src)
    - [src/lib.rs](#srclibrs)
    - [target/](#target)
- [Learn More](#learn-more)

## Requirements (only for building the binary yourself)

Please ensure you have installed the [required dependencies for the library for Rust code](/README.md#requirements), as
well as the following:

- Python < 3.11
- Yarn v1

### Windows

On Windows, you will also need an LLVM. Our workflow uses
`https://github.com/llvm/llvm-project/releases/download/llvmorg-11.0.1/LLVM-11.0.1-win64.exe`. You may also need to set
an environment variable `RUSTFLAGS` to `-C target-feature=+crt-static`.

## Getting Started

### Installing the IOTA SDK

#### Install With a Package Manager

To install the library from your package manager of choice, you only need to run the following:

##### npm

```sh
npm i @iota/sdk
```

##### Yarn:

```sh
yarn add @iota/sdk
```

#### Install the Binding from Source

Installing the Node.js bindings requires
a [supported version of Node and Rust](https://github.com/neon-bindings/neon#platform-support).

This will guide you in any dependencies and running the build.

##### Build nodejs bindings

If you have already installed the project and only want to run the build, run the following:

```sh
npm run build
```

This command uses the [cargo-cp-artifact](https://github.com/neon-bindings/cargo-cp-artifact) utility to run the Rust
build and copy the built library into `./build/Release/index.node`.
Prebuild requires that the binary is in `build/Release` as though it was built with node-gyp.

### Usage

#### Wallet

After you [installed the library](#install-the-iota-sdk), you can create a `Wallet` instance and interact with it.

```javascript
import { initLogger, Wallet, CoinType, WalletOptions } from '@iota/sdk';

const walletOptions: WalletOptions = {
    storagePath: `Alice`, // A name to associate with the created account.
    clientOptions: {
        nodes: ['https://api.testnet.shimmer.network'], // The node to connect to.
    },
    coinType: CoinType.Shimmer,
    secretManager: {
        // Setup Stronghold secret manager
        stronghold: {
            snapshotPath: 'vault.stronghold', //  The path to store the account snapshot.
            password: 'a-secure-password', // A password to encrypt the stored data. WARNING: Never hardcode passwords in production code.
        },
    },
};
const wallet = new Wallet(walletOptions);
```

#### Client

After you [installed the library](#install-the-iota-sdk), you can create a `Client` instance and interface with it.

```javascript
const { Client, initLogger } = require('@iota/sdk');

async function run() {
    initLogger();

    const client = new Client({
        nodes: ['https://api.testnet.shimmer.network'],
        localPow: true,
    });

    try {
        const nodeInfo = await client.getInfo();
        console.log('Node info: ', nodeInfo);
    } catch (error) {
        console.error('Error: ', error);
    }
}

run().then(() => process.exit());
```

#### Examples

You can use the provided code [examples](examples) to acquainted with the IOTA SDK. You can use the following command to run any example:

```bash
cd examples
yarn run-example ./[example folder]/[example file]
```

- Where `[example file]` is the file name from the example folder. For example:

```bash
node examples/client/00_get_info.ts
```

## Available Scripts

In the project directory, you can run the following:

### `npm install`

Installs the project, including running `npm run build`.

### `npm build`

Builds the Node addon (`index.node`) from source.

### `npm test`

Runs the unit tests by calling `cargo test`. You can learn more
about [adding tests to your Rust code](https://doc.rust-lang.org/book/ch11-01-writing-tests.html) from
the [Rust book](https://doc.rust-lang.org/book/).

### Cargo.toml

The Cargo [manifest file](https://doc.rust-lang.org/cargo/reference/manifest.html) informs the `cargo` command.

### README.md

This file.

### index.node

The Node addon - i.e., a binary Node module - is generated by building the project. This is the main module for this package,
as dictated by the `"main"` key in `package.json`.

Under the hood, a [Node addon](https://nodejs.org/api/addons.html) is
a [dynamically-linked shared object](<https://en.wikipedia.org/wiki/Library_(computing)#Shared_libraries>). The `"build"`
script produces this file by copying it from within the `target/` directory, which is where the Rust build produces the shared object.

### package.json

The npm [manifest file](https://docs.npmjs.com/cli/v7/configuring-npm/package-json), which informs the `npm` command.

### src/

The directory tree that contains the Rust source code for the project.

### src/lib.rs

The Rust library's main module.

### target/

Binary artifacts generated by the Rust build.

## Learn More

To learn more about Neon, see the [Neon documentation](https://neon-bindings.com).

To learn more about Rust, see the [Rust documentation](https://www.rust-lang.org).

To learn more about Node, see the [Node documentation](https://nodejs.org).
